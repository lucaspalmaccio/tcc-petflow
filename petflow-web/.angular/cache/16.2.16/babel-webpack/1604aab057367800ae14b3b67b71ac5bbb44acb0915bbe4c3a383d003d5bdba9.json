{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport { Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"../../../admin/services/agendamento.service\";\nimport * as i3 from \"../../../admin/services/servico.service\";\nimport * as i4 from \"@angular/common\";\nfunction AgendamentoModalComponent_option_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 23);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const pet_r8 = ctx.$implicit;\n    i0.ɵɵproperty(\"ngValue\", pet_r8.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate3(\" \", pet_r8.nome, \" (\", pet_r8.especie, \" - \", pet_r8.raca, \") \");\n  }\n}\nfunction AgendamentoModalComponent_div_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 24);\n    i0.ɵɵtext(1, \" Selecione um pet. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AgendamentoModalComponent_div_25_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 25)(1, \"input\", 26);\n    i0.ɵɵlistener(\"change\", function AgendamentoModalComponent_div_25_Template_input_change_1_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.onServicoChange($event));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(2, \"label\", 27);\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"currency\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const servico_r9 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"id\", \"servico-\" + servico_r9.id)(\"value\", servico_r9.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"for\", \"servico-\" + servico_r9.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\" \", servico_r9.nome, \" (\", i0.ɵɵpipeBind2(4, 5, servico_r9.preco, \"BRL\"), \") \");\n  }\n}\nfunction AgendamentoModalComponent_div_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 24);\n    i0.ɵɵtext(1, \" Selecione pelo menos um servi\\u00E7o. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AgendamentoModalComponent_div_35_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 24);\n    i0.ɵɵtext(1, \" Selecione uma data e hora. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AgendamentoModalComponent_div_36_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 24);\n    i0.ɵɵtext(1, \" A data deve ser no futuro. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AgendamentoModalComponent_div_39_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 28)(1, \"strong\");\n    i0.ɵɵtext(2, \"Valor Total Estimado:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(3);\n    i0.ɵɵpipe(4, \"currency\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(4, 1, ctx_r6.valorTotal, \"BRL\"), \" \");\n  }\n}\nfunction AgendamentoModalComponent_div_40_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 29);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r7 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r7.errorMessage, \" \");\n  }\n}\nclass AgendamentoModalComponent {\n  constructor(fb, agendamentoService, servicoService // Injetar para pegar os preços\n  ) {\n    this.fb = fb;\n    this.agendamentoService = agendamentoService;\n    this.servicoService = servicoService;\n    this.closeModal = new EventEmitter();\n    this.saveSuccess = new EventEmitter();\n    this.isLoading = false;\n    this.errorMessage = null;\n    this.valorTotal = 0;\n    this.servicosCache = []; // Cache para cálculo do valor\n    this.agendamentoForm = this.fb.group({\n      petId: [null, Validators.required],\n      dataHora: ['', Validators.required],\n      servicoIds: this.fb.array([], Validators.required) // Array de checkboxes\n    });\n    // Define a data/hora mínima como o momento atual\n    // Formato (YYYY-MM-DDTHH:mm) é necessário para o input datetime-local\n    const now = new Date();\n    // Ajusta para o fuso horário local\n    now.setMinutes(now.getMinutes() - now.getTimezoneOffset());\n    // Converte para o formato ISO e corta os segundos/milissegundos\n    this.minDate = now.toISOString().slice(0, 16);\n  }\n  ngOnInit() {\n    // Carrega o cache de serviços para cálculo do preço\n    this.servicosDisponiveis$.subscribe(servicos => this.servicosCache = servicos);\n  }\n  get servicosFormArray() {\n    return this.agendamentoForm.get('servicoIds');\n  }\n  // Função para lidar com a mudança nos checkboxes de serviço\n  onServicoChange(event) {\n    const checkbox = event.target;\n    const servicoId = parseInt(checkbox.value, 10);\n    if (checkbox.checked) {\n      this.servicosFormArray.push(this.fb.control(servicoId));\n    } else {\n      const index = this.servicosFormArray.controls.findIndex(x => x.value === servicoId);\n      if (index !== -1) {\n        this.servicosFormArray.removeAt(index);\n      }\n    }\n    this.calcularValorTotal();\n  }\n  // Calcula o valor total com base nos serviços selecionados\n  calcularValorTotal() {\n    this.valorTotal = this.servicosFormArray.value.reduce((total, servicoId) => {\n      const servico = this.servicosCache.find(s => s.id === servicoId);\n      return total + (servico?.preco || 0);\n    }, 0);\n  }\n  /**\n   * Envia o formulário para criar o agendamento\n   * UC05 - Fluxo Principal [150] a [152]\n   */\n  submitForm() {\n    if (this.agendamentoForm.invalid || this.servicosFormArray.length === 0) {\n      this.errorMessage = \"Selecione o pet, a data/hora e pelo menos um serviço.\";\n      return;\n    }\n    this.isLoading = true;\n    this.errorMessage = null;\n    const formValue = this.agendamentoForm.value;\n    // Ajusta o formato da data/hora para ISO String (YYYY-MM-DDTHH:mm:ss)\n    const dataHoraISO = new Date(formValue.dataHora).toISOString().slice(0, 19);\n    const dto = {\n      clienteId: null,\n      petId: formValue.petId,\n      dataHora: dataHoraISO,\n      servicoIds: formValue.servicoIds\n    };\n    this.agendamentoService.createAgendamento(dto).subscribe({\n      next: () => {\n        this.isLoading = false;\n        this.saveSuccess.emit();\n        this.onClose();\n      },\n      error: err => {\n        this.isLoading = false;\n        // UC05 - Fluxo de Exceção [153] (Horário Indisponível)\n        this.errorMessage = err.error?.erro || \"Erro ao criar agendamento. Verifique a data/hora.\";\n        console.error(\"Erro ao criar agendamento:\", err);\n      }\n    });\n  }\n  /**\n   * Emite o evento para fechar o modal.\n   */\n  onClose() {\n    this.closeModal.emit();\n  }\n  static {\n    this.ɵfac = function AgendamentoModalComponent_Factory(t) {\n      return new (t || AgendamentoModalComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.AgendamentoService), i0.ɵɵdirectiveInject(i3.ServicoService));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: AgendamentoModalComponent,\n      selectors: [[\"app-agendamento-modal\"]],\n      inputs: {\n        petsCliente$: \"petsCliente$\",\n        servicosDisponiveis$: \"servicosDisponiveis$\"\n      },\n      outputs: {\n        closeModal: \"closeModal\",\n        saveSuccess: \"saveSuccess\"\n      },\n      decls: 46,\n      vars: 17,\n      consts: [[1, \"modal-overlay\", 3, \"click\"], [1, \"modal-container\"], [1, \"modal-header\"], [1, \"btn-close\", 3, \"click\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"modal-body\"], [1, \"form-section\"], [1, \"form-group\"], [\"for\", \"pet\", 1, \"form-label\"], [\"id\", \"pet\", \"formControlName\", \"petId\", 1, \"form-control\"], [\"disabled\", \"\", 3, \"ngValue\"], [3, \"ngValue\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"text-danger\", 4, \"ngIf\"], [1, \"form-group\", \"service-list\"], [\"class\", \"service-item\", 4, \"ngFor\", \"ngForOf\"], [\"for\", \"dataHora\", 1, \"form-label\"], [\"id\", \"dataHora\", \"type\", \"datetime-local\", \"formControlName\", \"dataHora\", 1, \"form-control\", 3, \"min\"], [1, \"horario-info\"], [\"class\", \"agendamento-resumo\", 4, \"ngIf\"], [\"class\", \"error-message\", 4, \"ngIf\"], [1, \"modal-footer\"], [\"type\", \"button\", 1, \"btn-secondary\", 3, \"click\"], [\"type\", \"submit\", 1, \"btn-primary\", 3, \"disabled\"], [3, \"ngValue\"], [1, \"text-danger\"], [1, \"service-item\"], [\"type\", \"checkbox\", 3, \"id\", \"value\", \"change\"], [3, \"for\"], [1, \"agendamento-resumo\"], [1, \"error-message\"]],\n      template: function AgendamentoModalComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0);\n          i0.ɵɵlistener(\"click\", function AgendamentoModalComponent_Template_div_click_0_listener() {\n            return ctx.onClose();\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(1, \"div\", 1)(2, \"header\", 2)(3, \"h2\");\n          i0.ɵɵtext(4, \"Solicitar Novo Agendamento\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(5, \"button\", 3);\n          i0.ɵɵlistener(\"click\", function AgendamentoModalComponent_Template_button_click_5_listener() {\n            return ctx.onClose();\n          });\n          i0.ɵɵtext(6, \"\\u00D7\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(7, \"form\", 4);\n          i0.ɵɵlistener(\"ngSubmit\", function AgendamentoModalComponent_Template_form_ngSubmit_7_listener() {\n            return ctx.submitForm();\n          });\n          i0.ɵɵelementStart(8, \"div\", 5)(9, \"fieldset\", 6)(10, \"legend\");\n          i0.ɵɵtext(11, \"1. Selecione o Pet\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(12, \"div\", 7)(13, \"label\", 8);\n          i0.ɵɵtext(14, \"Pet\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(15, \"select\", 9)(16, \"option\", 10);\n          i0.ɵɵtext(17, \"-- Selecione um Pet --\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(18, AgendamentoModalComponent_option_18_Template, 2, 4, \"option\", 11);\n          i0.ɵɵpipe(19, \"async\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(20, AgendamentoModalComponent_div_20_Template, 2, 0, \"div\", 12);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(21, \"fieldset\", 6)(22, \"legend\");\n          i0.ɵɵtext(23, \"2. Selecione os Servi\\u00E7os\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(24, \"div\", 13);\n          i0.ɵɵtemplate(25, AgendamentoModalComponent_div_25_Template, 5, 8, \"div\", 14);\n          i0.ɵɵpipe(26, \"async\");\n          i0.ɵɵtemplate(27, AgendamentoModalComponent_div_27_Template, 2, 0, \"div\", 12);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(28, \"fieldset\", 6)(29, \"legend\");\n          i0.ɵɵtext(30, \"3. Escolha a Data e Hora\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(31, \"div\", 7)(32, \"label\", 15);\n          i0.ɵɵtext(33, \"Data e Hor\\u00E1rio\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(34, \"input\", 16);\n          i0.ɵɵtemplate(35, AgendamentoModalComponent_div_35_Template, 2, 0, \"div\", 12);\n          i0.ɵɵtemplate(36, AgendamentoModalComponent_div_36_Template, 2, 0, \"div\", 12);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(37, \"p\", 17);\n          i0.ɵɵtext(38, \"Hor\\u00E1rio de funcionamento: Seg-Sex 9h \\u00E0s 18h, S\\u00E1b 9h \\u00E0s 14h.\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(39, AgendamentoModalComponent_div_39_Template, 5, 4, \"div\", 18);\n          i0.ɵɵtemplate(40, AgendamentoModalComponent_div_40_Template, 2, 1, \"div\", 19);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(41, \"footer\", 20)(42, \"button\", 21);\n          i0.ɵɵlistener(\"click\", function AgendamentoModalComponent_Template_button_click_42_listener() {\n            return ctx.onClose();\n          });\n          i0.ɵɵtext(43, \" Cancelar \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(44, \"button\", 22);\n          i0.ɵɵtext(45);\n          i0.ɵɵelementEnd()()()();\n        }\n        if (rf & 2) {\n          let tmp_3_0;\n          let tmp_5_0;\n          let tmp_7_0;\n          let tmp_8_0;\n          i0.ɵɵadvance(7);\n          i0.ɵɵproperty(\"formGroup\", ctx.agendamentoForm);\n          i0.ɵɵadvance(9);\n          i0.ɵɵproperty(\"ngValue\", null);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(19, 13, ctx.petsCliente$));\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", ((tmp_3_0 = ctx.agendamentoForm.get(\"petId\")) == null ? null : tmp_3_0.touched) && ((tmp_3_0 = ctx.agendamentoForm.get(\"petId\")) == null ? null : tmp_3_0.hasError(\"required\")));\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(26, 15, ctx.servicosDisponiveis$));\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", ((tmp_5_0 = ctx.agendamentoForm.get(\"servicoIds\")) == null ? null : tmp_5_0.touched) && ((tmp_5_0 = ctx.agendamentoForm.get(\"servicoIds\")) == null ? null : tmp_5_0.hasError(\"required\")));\n          i0.ɵɵadvance(7);\n          i0.ɵɵproperty(\"min\", ctx.minDate);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ((tmp_7_0 = ctx.agendamentoForm.get(\"dataHora\")) == null ? null : tmp_7_0.touched) && ((tmp_7_0 = ctx.agendamentoForm.get(\"dataHora\")) == null ? null : tmp_7_0.hasError(\"required\")));\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ((tmp_8_0 = ctx.agendamentoForm.get(\"dataHora\")) == null ? null : tmp_8_0.touched) && ((tmp_8_0 = ctx.agendamentoForm.get(\"dataHora\")) == null ? null : tmp_8_0.hasError(\"min\")));\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngIf\", ctx.valorTotal > 0);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.errorMessage);\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"disabled\", ctx.isLoading || ctx.agendamentoForm.invalid || ctx.valorTotal === 0);\n          i0.ɵɵadvance(1);\n          i0.ɵɵtextInterpolate1(\" \", ctx.isLoading ? \"Solicitando...\" : \"Confirmar Agendamento\", \" \");\n        }\n      },\n      dependencies: [i4.NgForOf, i4.NgIf, i1.ɵNgNoValidate, i1.NgSelectOption, i1.ɵNgSelectMultipleOption, i1.DefaultValueAccessor, i1.SelectControlValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormControlName, i4.AsyncPipe, i4.CurrencyPipe],\n      styles: [\"\\n\\n.modal-overlay[_ngcontent-%COMP%] {\\n  position: fixed;\\n  top: 0;\\n  left: 0;\\n  width: 100vw;\\n  height: 100vh;\\n  background-color: rgba(0, 0, 0, 0.5);\\n  z-index: 1000;\\n}\\n\\n.modal-container[_ngcontent-%COMP%] {\\n  position: fixed;\\n  top: 50%;\\n  left: 50%;\\n  transform: translate(-50%, -50%);\\n  width: 90%; \\n\\n  max-width: 600px; \\n\\n  background-color: var(--color-white);\\n  border-radius: 8px;\\n  box-shadow: var(--shadow-md);\\n  z-index: 1001;\\n  display: flex;\\n  flex-direction: column;\\n  max-height: 90vh; \\n\\n}\\n\\n.modal-header[_ngcontent-%COMP%] {\\n  display: flex;\\n  justify-content: space-between;\\n  align-items: center;\\n  padding: 1rem 1.5rem;\\n  border-bottom: 1px solid var(--color-border);\\n  flex-shrink: 0; \\n\\n}\\n.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%] {\\n  font-size: 1.25rem;\\n  font-weight: 600;\\n}\\n.btn-close[_ngcontent-%COMP%] {\\n  background: none;\\n  border: none;\\n  font-size: 1.5rem;\\n  color: var(--color-secondary);\\n  cursor: pointer;\\n}\\n\\n.modal-body[_ngcontent-%COMP%] {\\n  padding: 1.5rem;\\n  overflow-y: auto; \\n\\n  flex-grow: 1;\\n}\\n\\n.modal-footer[_ngcontent-%COMP%] {\\n  display: flex;\\n  justify-content: flex-end;\\n  gap: 0.5rem;\\n  padding: 1rem 1.5rem;\\n  border-top: 1px solid var(--color-border);\\n  flex-shrink: 0; \\n\\n}\\n\\n.btn-secondary[_ngcontent-%COMP%] {\\n  background-color: var(--color-light);\\n  color: var(--color-dark);\\n  border: 1px solid var(--color-border);\\n}\\n.btn-secondary[_ngcontent-%COMP%]:hover {\\n  background-color: #e2e6ea;\\n}\\n\\n.error-message[_ngcontent-%COMP%] {\\n  color: var(--color-danger);\\n  margin-top: 1rem;\\n  font-size: 0.9rem;\\n}\\n\\n\\n\\n.form-section[_ngcontent-%COMP%] {\\n  border: none;\\n  padding: 0;\\n  margin-bottom: 1.5rem;\\n}\\n.form-section[_ngcontent-%COMP%]   legend[_ngcontent-%COMP%] {\\n  font-size: 1.1rem;\\n  font-weight: 600;\\n  margin-bottom: 1rem;\\n}\\n\\n\\n\\n.service-list[_ngcontent-%COMP%] {\\n  max-height: 150px; \\n\\n  overflow-y: auto;\\n  border: 1px solid var(--color-border);\\n  border-radius: 4px;\\n  padding: 0.5rem;\\n}\\n\\n.service-item[_ngcontent-%COMP%] {\\n  display: flex;\\n  align-items: center;\\n  margin-bottom: 0.5rem;\\n}\\n.service-item[_ngcontent-%COMP%]   input[type=\\\"checkbox\\\"][_ngcontent-%COMP%] {\\n  margin-right: 0.5rem;\\n  cursor: pointer;\\n}\\n.service-item[_ngcontent-%COMP%]   label[_ngcontent-%COMP%] {\\n  cursor: pointer;\\n}\\n\\n\\n\\ninput[type=\\\"datetime-local\\\"][_ngcontent-%COMP%] {\\n  \\n\\n  padding: 8px 12px;\\n}\\n\\n.horario-info[_ngcontent-%COMP%] {\\n  font-size: 0.85rem;\\n  color: var(--color-secondary);\\n  margin-top: 0.5rem;\\n}\\n\\n\\n\\n.agendamento-resumo[_ngcontent-%COMP%] {\\n  margin-top: 1.5rem;\\n  padding-top: 1rem;\\n  border-top: 1px dashed var(--color-border);\\n  font-size: 1.1rem;\\n  text-align: right;\\n}\\n\\n\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvZmVhdHVyZXMvY2xpZW50ZS9jb21wb25lbnRzL2FnZW5kYW1lbnRvLW1vZGFsL2FnZW5kYW1lbnRvLW1vZGFsLmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsdURBQXVEO0FBQ3ZEO0VBQ0UsZUFBZTtFQUNmLE1BQU07RUFDTixPQUFPO0VBQ1AsWUFBWTtFQUNaLGFBQWE7RUFDYixvQ0FBb0M7RUFDcEMsYUFBYTtBQUNmOztBQUVBO0VBQ0UsZUFBZTtFQUNmLFFBQVE7RUFDUixTQUFTO0VBQ1QsZ0NBQWdDO0VBQ2hDLFVBQVUsRUFBRSxvQ0FBb0M7RUFDaEQsZ0JBQWdCLEVBQUUsd0NBQXdDO0VBQzFELG9DQUFvQztFQUNwQyxrQkFBa0I7RUFDbEIsNEJBQTRCO0VBQzVCLGFBQWE7RUFDYixhQUFhO0VBQ2Isc0JBQXNCO0VBQ3RCLGdCQUFnQixFQUFFLHNDQUFzQztBQUMxRDs7QUFFQTtFQUNFLGFBQWE7RUFDYiw4QkFBOEI7RUFDOUIsbUJBQW1CO0VBQ25CLG9CQUFvQjtFQUNwQiw0Q0FBNEM7RUFDNUMsY0FBYyxFQUFFLGdDQUFnQztBQUNsRDtBQUNBO0VBQ0Usa0JBQWtCO0VBQ2xCLGdCQUFnQjtBQUNsQjtBQUNBO0VBQ0UsZ0JBQWdCO0VBQ2hCLFlBQVk7RUFDWixpQkFBaUI7RUFDakIsNkJBQTZCO0VBQzdCLGVBQWU7QUFDakI7O0FBRUE7RUFDRSxlQUFlO0VBQ2YsZ0JBQWdCLEVBQUUsNENBQTRDO0VBQzlELFlBQVk7QUFDZDs7QUFFQTtFQUNFLGFBQWE7RUFDYix5QkFBeUI7RUFDekIsV0FBVztFQUNYLG9CQUFvQjtFQUNwQix5Q0FBeUM7RUFDekMsY0FBYyxFQUFFLGdDQUFnQztBQUNsRDs7QUFFQTtFQUNFLG9DQUFvQztFQUNwQyx3QkFBd0I7RUFDeEIscUNBQXFDO0FBQ3ZDO0FBQ0E7RUFDRSx5QkFBeUI7QUFDM0I7O0FBRUE7RUFDRSwwQkFBMEI7RUFDMUIsZ0JBQWdCO0VBQ2hCLGlCQUFpQjtBQUNuQjs7QUFFQSxxREFBcUQ7QUFDckQ7RUFDRSxZQUFZO0VBQ1osVUFBVTtFQUNWLHFCQUFxQjtBQUN2QjtBQUNBO0VBQ0UsaUJBQWlCO0VBQ2pCLGdCQUFnQjtFQUNoQixtQkFBbUI7QUFDckI7O0FBRUEsbUNBQW1DO0FBQ25DO0VBQ0UsaUJBQWlCLEVBQUUsNkJBQTZCO0VBQ2hELGdCQUFnQjtFQUNoQixxQ0FBcUM7RUFDckMsa0JBQWtCO0VBQ2xCLGVBQWU7QUFDakI7O0FBRUE7RUFDRSxhQUFhO0VBQ2IsbUJBQW1CO0VBQ25CLHFCQUFxQjtBQUN2QjtBQUNBO0VBQ0Usb0JBQW9CO0VBQ3BCLGVBQWU7QUFDakI7QUFDQTtFQUNFLGVBQWU7QUFDakI7O0FBRUEsdUJBQXVCO0FBQ3ZCO0VBQ0Usc0RBQXNEO0VBQ3RELGlCQUFpQjtBQUNuQjs7QUFFQTtFQUNFLGtCQUFrQjtFQUNsQiw2QkFBNkI7RUFDN0Isa0JBQWtCO0FBQ3BCOztBQUVBLG9CQUFvQjtBQUNwQjtFQUNFLGtCQUFrQjtFQUNsQixpQkFBaUI7RUFDakIsMENBQTBDO0VBQzFDLGlCQUFpQjtFQUNqQixpQkFBaUI7QUFDbkIiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBSZXV0aWxpemEgZXN0aWxvcyBkbyBtb2RhbCBkZSBwZXQsIG1hcyBjb20gYWp1c3RlcyAqL1xyXG4ubW9kYWwtb3ZlcmxheSB7XHJcbiAgcG9zaXRpb246IGZpeGVkO1xyXG4gIHRvcDogMDtcclxuICBsZWZ0OiAwO1xyXG4gIHdpZHRoOiAxMDB2dztcclxuICBoZWlnaHQ6IDEwMHZoO1xyXG4gIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC41KTtcclxuICB6LWluZGV4OiAxMDAwO1xyXG59XHJcblxyXG4ubW9kYWwtY29udGFpbmVyIHtcclxuICBwb3NpdGlvbjogZml4ZWQ7XHJcbiAgdG9wOiA1MCU7XHJcbiAgbGVmdDogNTAlO1xyXG4gIHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC01MCUpO1xyXG4gIHdpZHRoOiA5MCU7IC8qIEFqdXN0ZSBwYXJhIHNlciBtYWlzIHJlc3BvbnNpdm8gKi9cclxuICBtYXgtd2lkdGg6IDYwMHB4OyAvKiBVbSBwb3VjbyBtYWlvciBwYXJhIGNhYmVyIG1haXMgaW5mbyAqL1xyXG4gIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWNvbG9yLXdoaXRlKTtcclxuICBib3JkZXItcmFkaXVzOiA4cHg7XHJcbiAgYm94LXNoYWRvdzogdmFyKC0tc2hhZG93LW1kKTtcclxuICB6LWluZGV4OiAxMDAxO1xyXG4gIGRpc3BsYXk6IGZsZXg7XHJcbiAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjtcclxuICBtYXgtaGVpZ2h0OiA5MHZoOyAvKiBMaW1pdGEgYSBhbHR1cmEgZW0gdGVsYXMgcGVxdWVuYXMgKi9cclxufVxyXG5cclxuLm1vZGFsLWhlYWRlciB7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XHJcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICBwYWRkaW5nOiAxcmVtIDEuNXJlbTtcclxuICBib3JkZXItYm90dG9tOiAxcHggc29saWQgdmFyKC0tY29sb3ItYm9yZGVyKTtcclxuICBmbGV4LXNocmluazogMDsgLyogSW1wZWRlIG8gaGVhZGVyIGRlIGVuY29saGVyICovXHJcbn1cclxuLm1vZGFsLWhlYWRlciBoMiB7XHJcbiAgZm9udC1zaXplOiAxLjI1cmVtO1xyXG4gIGZvbnQtd2VpZ2h0OiA2MDA7XHJcbn1cclxuLmJ0bi1jbG9zZSB7XHJcbiAgYmFja2dyb3VuZDogbm9uZTtcclxuICBib3JkZXI6IG5vbmU7XHJcbiAgZm9udC1zaXplOiAxLjVyZW07XHJcbiAgY29sb3I6IHZhcigtLWNvbG9yLXNlY29uZGFyeSk7XHJcbiAgY3Vyc29yOiBwb2ludGVyO1xyXG59XHJcblxyXG4ubW9kYWwtYm9keSB7XHJcbiAgcGFkZGluZzogMS41cmVtO1xyXG4gIG92ZXJmbG93LXk6IGF1dG87IC8qIFBlcm1pdGUgc2Nyb2xsIHNlIG8gY29udGXDg8K6ZG8gZm9yIGdyYW5kZSAqL1xyXG4gIGZsZXgtZ3JvdzogMTtcclxufVxyXG5cclxuLm1vZGFsLWZvb3RlciB7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtZW5kO1xyXG4gIGdhcDogMC41cmVtO1xyXG4gIHBhZGRpbmc6IDFyZW0gMS41cmVtO1xyXG4gIGJvcmRlci10b3A6IDFweCBzb2xpZCB2YXIoLS1jb2xvci1ib3JkZXIpO1xyXG4gIGZsZXgtc2hyaW5rOiAwOyAvKiBJbXBlZGUgbyBmb290ZXIgZGUgZW5jb2xoZXIgKi9cclxufVxyXG5cclxuLmJ0bi1zZWNvbmRhcnkge1xyXG4gIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWNvbG9yLWxpZ2h0KTtcclxuICBjb2xvcjogdmFyKC0tY29sb3ItZGFyayk7XHJcbiAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tY29sb3ItYm9yZGVyKTtcclxufVxyXG4uYnRuLXNlY29uZGFyeTpob3ZlciB7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogI2UyZTZlYTtcclxufVxyXG5cclxuLmVycm9yLW1lc3NhZ2Uge1xyXG4gIGNvbG9yOiB2YXIoLS1jb2xvci1kYW5nZXIpO1xyXG4gIG1hcmdpbi10b3A6IDFyZW07XHJcbiAgZm9udC1zaXplOiAwLjlyZW07XHJcbn1cclxuXHJcbi8qIEVzdGlsb3MgZXNwZWPDg8KtZmljb3MgZG8gZm9ybXVsw4PCoXJpbyBkZSBhZ2VuZGFtZW50byAqL1xyXG4uZm9ybS1zZWN0aW9uIHtcclxuICBib3JkZXI6IG5vbmU7XHJcbiAgcGFkZGluZzogMDtcclxuICBtYXJnaW4tYm90dG9tOiAxLjVyZW07XHJcbn1cclxuLmZvcm0tc2VjdGlvbiBsZWdlbmQge1xyXG4gIGZvbnQtc2l6ZTogMS4xcmVtO1xyXG4gIGZvbnQtd2VpZ2h0OiA2MDA7XHJcbiAgbWFyZ2luLWJvdHRvbTogMXJlbTtcclxufVxyXG5cclxuLyogTGlzdGEgZGUgU2VydmnDg8Knb3MgKENoZWNrYm94ZXMpICovXHJcbi5zZXJ2aWNlLWxpc3Qge1xyXG4gIG1heC1oZWlnaHQ6IDE1MHB4OyAvKiBMaW1pdGEgYSBhbHR1cmEgZGEgbGlzdGEgKi9cclxuICBvdmVyZmxvdy15OiBhdXRvO1xyXG4gIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWNvbG9yLWJvcmRlcik7XHJcbiAgYm9yZGVyLXJhZGl1czogNHB4O1xyXG4gIHBhZGRpbmc6IDAuNXJlbTtcclxufVxyXG5cclxuLnNlcnZpY2UtaXRlbSB7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBhbGlnbi1pdGVtczogY2VudGVyO1xyXG4gIG1hcmdpbi1ib3R0b206IDAuNXJlbTtcclxufVxyXG4uc2VydmljZS1pdGVtIGlucHV0W3R5cGU9XCJjaGVja2JveFwiXSB7XHJcbiAgbWFyZ2luLXJpZ2h0OiAwLjVyZW07XHJcbiAgY3Vyc29yOiBwb2ludGVyO1xyXG59XHJcbi5zZXJ2aWNlLWl0ZW0gbGFiZWwge1xyXG4gIGN1cnNvcjogcG9pbnRlcjtcclxufVxyXG5cclxuLyogSW5wdXQgZGUgRGF0YS9Ib3JhICovXHJcbmlucHV0W3R5cGU9XCJkYXRldGltZS1sb2NhbFwiXSB7XHJcbiAgLyogRXN0aWxpemHDg8Knw4PCo28gYsODwqFzaWNhLCBwb2RlIHZhcmlhciBlbnRyZSBuYXZlZ2Fkb3JlcyAqL1xyXG4gIHBhZGRpbmc6IDhweCAxMnB4O1xyXG59XHJcblxyXG4uaG9yYXJpby1pbmZvIHtcclxuICBmb250LXNpemU6IDAuODVyZW07XHJcbiAgY29sb3I6IHZhcigtLWNvbG9yLXNlY29uZGFyeSk7XHJcbiAgbWFyZ2luLXRvcDogMC41cmVtO1xyXG59XHJcblxyXG4vKiBSZXN1bW8gZG8gVmFsb3IgKi9cclxuLmFnZW5kYW1lbnRvLXJlc3VtbyB7XHJcbiAgbWFyZ2luLXRvcDogMS41cmVtO1xyXG4gIHBhZGRpbmctdG9wOiAxcmVtO1xyXG4gIGJvcmRlci10b3A6IDFweCBkYXNoZWQgdmFyKC0tY29sb3ItYm9yZGVyKTtcclxuICBmb250LXNpemU6IDEuMXJlbTtcclxuICB0ZXh0LWFsaWduOiByaWdodDtcclxufVxyXG5cclxuIl0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n    });\n  }\n}\nexport { AgendamentoModalComponent };","map":{"version":3,"names":["EventEmitter","Validators","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵproperty","pet_r8","id","ɵɵadvance","ɵɵtextInterpolate3","nome","especie","raca","ɵɵlistener","AgendamentoModalComponent_div_25_Template_input_change_1_listener","$event","ɵɵrestoreView","_r11","ctx_r10","ɵɵnextContext","ɵɵresetView","onServicoChange","servico_r9","ɵɵtextInterpolate2","ɵɵpipeBind2","preco","ɵɵtextInterpolate1","ctx_r6","valorTotal","ctx_r7","errorMessage","AgendamentoModalComponent","constructor","fb","agendamentoService","servicoService","closeModal","saveSuccess","isLoading","servicosCache","agendamentoForm","group","petId","required","dataHora","servicoIds","array","now","Date","setMinutes","getMinutes","getTimezoneOffset","minDate","toISOString","slice","ngOnInit","servicosDisponiveis$","subscribe","servicos","servicosFormArray","get","event","checkbox","target","servicoId","parseInt","value","checked","push","control","index","controls","findIndex","x","removeAt","calcularValorTotal","reduce","total","servico","find","s","submitForm","invalid","length","formValue","dataHoraISO","dto","clienteId","createAgendamento","next","emit","onClose","error","err","erro","console","ɵɵdirectiveInject","i1","FormBuilder","i2","AgendamentoService","i3","ServicoService","selectors","inputs","petsCliente$","outputs","decls","vars","consts","template","AgendamentoModalComponent_Template","rf","ctx","AgendamentoModalComponent_Template_div_click_0_listener","AgendamentoModalComponent_Template_button_click_5_listener","AgendamentoModalComponent_Template_form_ngSubmit_7_listener","ɵɵtemplate","AgendamentoModalComponent_option_18_Template","AgendamentoModalComponent_div_20_Template","AgendamentoModalComponent_div_25_Template","AgendamentoModalComponent_div_27_Template","ɵɵelement","AgendamentoModalComponent_div_35_Template","AgendamentoModalComponent_div_36_Template","AgendamentoModalComponent_div_39_Template","AgendamentoModalComponent_div_40_Template","AgendamentoModalComponent_Template_button_click_42_listener","ɵɵpipeBind1","tmp_3_0","touched","hasError","tmp_5_0","tmp_7_0","tmp_8_0"],"sources":["C:\\TCC\\petflow\\petflow-web\\src\\app\\features\\cliente\\components\\agendamento-modal\\agendamento-modal.component.ts","C:\\TCC\\petflow\\petflow-web\\src\\app\\features\\cliente\\components\\agendamento-modal\\agendamento-modal.component.html"],"sourcesContent":["import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\r\nimport { FormBuilder, FormGroup, Validators, FormArray } from '@angular/forms';\r\nimport { Observable, catchError, of } from 'rxjs';\r\nimport { Pet } from '../../../admin/models/pet.model';\r\nimport { Servico } from '../../../admin/models/servico.model';\r\nimport { AgendamentoService } from '../../../admin/services/agendamento.service';\r\nimport { AgendamentoRequestDTO } from '../../../admin/models/agendamento.model';\r\nimport { ServicoService } from '../../../admin/services/servico.service'; // Import corrigido\r\n\r\n@Component({\r\nselector: 'app-agendamento-modal',\r\ntemplateUrl: './agendamento-modal.component.html',\r\nstyleUrls: ['./agendamento-modal.component.css']\r\n})\r\nexport class AgendamentoModalComponent implements OnInit {\r\n\r\n// Dados recebidos do componente pai\r\n@Input() petsCliente$!: Observable<Pet[]>;\r\n@Input() servicosDisponiveis$!: Observable<Servico[]>;\r\n@Output() closeModal = new EventEmitter<void>();\r\n@Output() saveSuccess = new EventEmitter<void>();\r\n\r\n// Estado do componente\r\nagendamentoForm: FormGroup;\r\nisLoading = false;\r\nerrorMessage: string | null = null;\r\npublic valorTotal = 0;\r\nprivate servicosCache: Servico[] = []; // Cache para cálculo do valor\r\n\r\n// Propriedade para o input de data\r\npublic minDate: string;\r\n\r\nconstructor(\r\n    private fb: FormBuilder,\r\n    private agendamentoService: AgendamentoService,\r\n    private servicoService: ServicoService // Injetar para pegar os preços\r\n  ) {\r\n    this.agendamentoForm = this.fb.group({\r\n      petId: [null, Validators.required],\r\n      dataHora: ['', Validators.required],\r\n      servicoIds: this.fb.array([], Validators.required) // Array de checkboxes\r\n    });\r\n\r\n    // Define a data/hora mínima como o momento atual\r\n    // Formato (YYYY-MM-DDTHH:mm) é necessário para o input datetime-local\r\n    const now = new Date();\r\n    // Ajusta para o fuso horário local\r\n    now.setMinutes(now.getMinutes() - now.getTimezoneOffset());\r\n    // Converte para o formato ISO e corta os segundos/milissegundos\r\n    this.minDate = now.toISOString().slice(0, 16);\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    // Carrega o cache de serviços para cálculo do preço\r\n    this.servicosDisponiveis$.subscribe(servicos => this.servicosCache = servicos);\r\n  }\r\n\r\n  get servicosFormArray(): FormArray {\r\n    return this.agendamentoForm.get('servicoIds') as FormArray;\r\n  }\r\n\r\n  // Função para lidar com a mudança nos checkboxes de serviço\r\n  onServicoChange(event: Event): void {\r\n    const checkbox = event.target as HTMLInputElement;\r\n    const servicoId = parseInt(checkbox.value, 10);\r\n\r\n    if (checkbox.checked) {\r\n      this.servicosFormArray.push(this.fb.control(servicoId));\r\n    } else {\r\n      const index = this.servicosFormArray.controls.findIndex(x => x.value === servicoId);\r\n      if (index !== -1) {\r\n        this.servicosFormArray.removeAt(index);\r\n      }\r\n    }\r\n    this.calcularValorTotal();\r\n  }\r\n\r\n  // Calcula o valor total com base nos serviços selecionados\r\n  calcularValorTotal(): void {\r\n    this.valorTotal = this.servicosFormArray.value.reduce((total: number, servicoId: number) => {\r\n      const servico = this.servicosCache.find(s => s.id === servicoId);\r\n      return total + (servico?.preco || 0);\r\n    }, 0);\r\n  }\r\n\r\n  /**\r\n   * Envia o formulário para criar o agendamento\r\n   * UC05 - Fluxo Principal [150] a [152]\r\n   */\r\n  submitForm(): void {\r\n    if (this.agendamentoForm.invalid || this.servicosFormArray.length === 0) {\r\n      this.errorMessage = \"Selecione o pet, a data/hora e pelo menos um serviço.\";\r\n      return;\r\n    }\r\n\r\n    this.isLoading = true;\r\n    this.errorMessage = null;\r\n\r\n    const formValue = this.agendamentoForm.value;\r\n\r\n    // Ajusta o formato da data/hora para ISO String (YYYY-MM-DDTHH:mm:ss)\r\n    const dataHoraISO = new Date(formValue.dataHora).toISOString().slice(0, 19);\r\n\r\n    const dto: AgendamentoRequestDTO = {\r\n      clienteId: null, // O back-end pega do token do cliente\r\n      petId: formValue.petId,\r\n      dataHora: dataHoraISO,\r\n      servicoIds: formValue.servicoIds\r\n    };\r\n\r\n    this.agendamentoService.createAgendamento(dto).subscribe({\r\n      next: () => {\r\n        this.isLoading = false;\r\n        this.saveSuccess.emit();\r\n        this.onClose();\r\n      },\r\n      error: (err) => {\r\n        this.isLoading = false;\r\n        // UC05 - Fluxo de Exceção [153] (Horário Indisponível)\r\n        this.errorMessage = err.error?.erro || \"Erro ao criar agendamento. Verifique a data/hora.\";\r\n        console.error(\"Erro ao criar agendamento:\", err);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Emite o evento para fechar o modal.\r\n   */\r\n  onClose(): void {\r\n    this.closeModal.emit();\r\n  }\r\n}\r\n\r\n","<!-- Overlay (fundo escuro) -->\r\n<div class=\"modal-overlay\" (click)=\"onClose()\"></div>\r\n\r\n<!-- Conteúdo do Modal -->\r\n<div class=\"modal-container\">\r\n    <header class=\"modal-header\">\r\n        <h2>Solicitar Novo Agendamento</h2>\r\n        <button class=\"btn-close\" (click)=\"onClose()\">×</button>\r\n    </header>\r\n\r\n    <form [formGroup]=\"agendamentoForm\" (ngSubmit)=\"submitForm()\">\r\n        <div class=\"modal-body\">\r\n\r\n            <!-- Etapa 1: Selecionar Pet (UC05 [329]) -->\r\n            <fieldset class=\"form-section\">\r\n                <legend>1. Selecione o Pet</legend>\r\n                <div class=\"form-group\">\r\n                    <label for=\"pet\" class=\"form-label\">Pet</label>\r\n                    <select id=\"pet\" class=\"form-control\" formControlName=\"petId\">\r\n                        <option [ngValue]=\"null\" disabled>-- Selecione um Pet --</option>\r\n                        <!-- Carrega os pets do cliente -->\r\n                        <option *ngFor=\"let pet of (petsCliente$ | async)\" [ngValue]=\"pet.id\">\r\n                            {{ pet.nome }} ({{ pet.especie }} - {{ pet.raca }})\r\n                        </option>\r\n                    </select>\r\n                    <div *ngIf=\"agendamentoForm.get('petId')?.touched && agendamentoForm.get('petId')?.hasError('required')\" class=\"text-danger\">\r\n                        Selecione um pet.\r\n                    </div>\r\n                </div>\r\n            </fieldset>\r\n\r\n            <!-- Etapa 2: Selecionar Serviços (UC05 [330]) -->\r\n            <fieldset class=\"form-section\">\r\n                <legend>2. Selecione os Serviços</legend>\r\n                <div class=\"form-group service-list\">\r\n                    <div *ngFor=\"let servico of (servicosDisponiveis$ | async)\" class=\"service-item\">\r\n                        <input type=\"checkbox\" [id]=\"'servico-' + servico.id\" [value]=\"servico.id\" (change)=\"onServicoChange($event)\">\r\n                        <label [for]=\"'servico-' + servico.id\">\r\n                            {{ servico.nome }} ({{ servico.preco | currency:'BRL' }})\r\n                        </label>\r\n                    </div>\r\n                    <div *ngIf=\"agendamentoForm.get('servicoIds')?.touched && agendamentoForm.get('servicoIds')?.hasError('required')\" class=\"text-danger\">\r\n                        Selecione pelo menos um serviço.\r\n                    </div>\r\n                </div>\r\n            </fieldset>\r\n\r\n            <!-- Etapa 3: Selecionar Data e Hora (UC05 [331-332]) -->\r\n            <fieldset class=\"form-section\">\r\n                <legend>3. Escolha a Data e Hora</legend>\r\n                <div class=\"form-group\">\r\n                    <label for=\"dataHora\" class=\"form-label\">Data e Horário</label>\r\n                    <!-- (Input type datetime-local é simples, mas funciona) -->\r\n                    <input id=\"dataHora\" type=\"datetime-local\" class=\"form-control\" formControlName=\"dataHora\" [min]=\"minDate\">\r\n                    <div *ngIf=\"agendamentoForm.get('dataHora')?.touched && agendamentoForm.get('dataHora')?.hasError('required')\" class=\"text-danger\">\r\n                        Selecione uma data e hora.\r\n                    </div>\r\n                    <div *ngIf=\"agendamentoForm.get('dataHora')?.touched && agendamentoForm.get('dataHora')?.hasError('min')\" class=\"text-danger\">\r\n                        A data deve ser no futuro.\r\n                    </div>\r\n                </div>\r\n                <p class=\"horario-info\">Horário de funcionamento: Seg-Sex 9h às 18h, Sáb 9h às 14h.</p>\r\n            </fieldset>\r\n\r\n            <!-- Resumo e Confirmação (UC05 [333]) -->\r\n            <div class=\"agendamento-resumo\" *ngIf=\"valorTotal > 0\">\r\n                <strong>Valor Total Estimado:</strong> {{ valorTotal | currency:'BRL' }}\r\n            </div>\r\n\r\n            <!-- Mensagem de Erro Geral -->\r\n            <div *ngIf=\"errorMessage\" class=\"error-message\">\r\n                {{ errorMessage }}\r\n            </div>\r\n        </div>\r\n\r\n        <!-- Rodapé com Botões -->\r\n        <footer class=\"modal-footer\">\r\n            <button type=\"button\" class=\"btn-secondary\" (click)=\"onClose()\">\r\n                Cancelar\r\n            </button>\r\n            <button type=\"submit\" class=\"btn-primary\" [disabled]=\"isLoading || agendamentoForm.invalid || valorTotal === 0\">\r\n                {{ isLoading ? 'Solicitando...' : 'Confirmar Agendamento' }}\r\n            </button>\r\n        </footer>\r\n    </form>\r\n</div>\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}