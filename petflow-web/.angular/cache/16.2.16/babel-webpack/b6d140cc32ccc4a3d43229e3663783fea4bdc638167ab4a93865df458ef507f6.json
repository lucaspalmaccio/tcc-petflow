{"ast":null,"code":"// Imports do Calendário\nimport {\n// <-- Importe este\nCalendarView } from 'angular-calendar';\nimport { endOfMonth, startOfMonth, endOfWeek, startOfWeek } from 'date-fns';\nimport { Subject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../admin/services/agendamento.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"angular-calendar\";\nfunction AgendaComponent_div_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 16);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.errorMessage, \" \");\n  }\n}\nfunction AgendaComponent_div_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 17);\n    i0.ɵɵtext(1, \" Carregando agendamentos... \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AgendaComponent_mwl_calendar_month_view_27_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"mwl-calendar-month-view\", 18);\n    i0.ɵɵlistener(\"dayClicked\", function AgendaComponent_mwl_calendar_month_view_27_Template_mwl_calendar_month_view_dayClicked_0_listener($event) {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext();\n      ctx_r7.setView(ctx_r7.CalendarView.Day);\n      return i0.ɵɵresetView(ctx_r7.viewDate = $event.day.date);\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"viewDate\", ctx_r2.viewDate)(\"events\", ctx_r2.events)(\"refresh\", ctx_r2.refresh)(\"locale\", ctx_r2.locale);\n  }\n}\nfunction AgendaComponent_mwl_calendar_week_view_28_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"mwl-calendar-week-view\", 19);\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"viewDate\", ctx_r3.viewDate)(\"events\", ctx_r3.events)(\"refresh\", ctx_r3.refresh)(\"locale\", ctx_r3.locale);\n  }\n}\nfunction AgendaComponent_mwl_calendar_day_view_29_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"mwl-calendar-day-view\", 19);\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"viewDate\", ctx_r4.viewDate)(\"events\", ctx_r4.events)(\"refresh\", ctx_r4.refresh)(\"locale\", ctx_r4.locale);\n  }\n}\nfunction AgendaComponent_div_30_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 20);\n    i0.ɵɵlistener(\"click\", function AgendaComponent_div_30_Template_div_click_0_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.closeAdminModal());\n    });\n    i0.ɵɵelementEnd();\n  }\n}\nfunction AgendaComponent_div_31_option_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 41);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const cliente_r15 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", cliente_r15.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", cliente_r15.nome, \" \");\n  }\n}\nfunction AgendaComponent_div_31_option_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 41);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const pet_r16 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", pet_r16.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", pet_r16.nome, \" \");\n  }\n}\nfunction AgendaComponent_div_31_option_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 41);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"currency\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const servico_r17 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", servico_r17.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\" \", servico_r17.nome, \" (\", i0.ɵɵpipeBind2(2, 3, servico_r17.preco, \"BRL\"), \") \");\n  }\n}\nfunction AgendaComponent_div_31_div_33_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 42);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r14 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r14.modalError, \" \");\n  }\n}\nfunction AgendaComponent_div_31_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r19 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 21)(1, \"div\", 22)(2, \"h2\");\n    i0.ɵɵtext(3, \"Novo Agendamento (Admin)\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"button\", 23);\n    i0.ɵɵlistener(\"click\", function AgendaComponent_div_31_Template_button_click_4_listener() {\n      i0.ɵɵrestoreView(_r19);\n      const ctx_r18 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r18.closeAdminModal());\n    });\n    i0.ɵɵtext(5, \"\\u00D7\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"form\", 24);\n    i0.ɵɵlistener(\"ngSubmit\", function AgendaComponent_div_31_Template_form_ngSubmit_6_listener() {\n      i0.ɵɵrestoreView(_r19);\n      const ctx_r20 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r20.onAdminSubmit());\n    });\n    i0.ɵɵelementStart(7, \"div\", 25)(8, \"div\", 26)(9, \"label\", 27);\n    i0.ɵɵtext(10, \"Cliente:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"select\", 28);\n    i0.ɵɵlistener(\"ngModelChange\", function AgendaComponent_div_31_Template_select_ngModelChange_11_listener($event) {\n      i0.ɵɵrestoreView(_r19);\n      const ctx_r21 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r21.agendamentoForm.clienteId = $event);\n    })(\"change\", function AgendaComponent_div_31_Template_select_change_11_listener($event) {\n      i0.ɵɵrestoreView(_r19);\n      const ctx_r22 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r22.onClienteChange($event));\n    });\n    i0.ɵɵelementStart(12, \"option\", 29);\n    i0.ɵɵtext(13, \"Selecione um cliente...\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(14, AgendaComponent_div_31_option_14_Template, 2, 2, \"option\", 30);\n    i0.ɵɵpipe(15, \"async\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(16, \"div\", 26)(17, \"label\", 31);\n    i0.ɵɵtext(18, \"Pet:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"select\", 32);\n    i0.ɵɵlistener(\"ngModelChange\", function AgendaComponent_div_31_Template_select_ngModelChange_19_listener($event) {\n      i0.ɵɵrestoreView(_r19);\n      const ctx_r23 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r23.agendamentoForm.petId = $event);\n    });\n    i0.ɵɵelementStart(20, \"option\", 29);\n    i0.ɵɵtext(21, \"Selecione um pet...\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(22, AgendaComponent_div_31_option_22_Template, 2, 2, \"option\", 30);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(23, \"div\", 26)(24, \"label\", 33);\n    i0.ɵɵtext(25, \"Servi\\u00E7os:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(26, \"select\", 34);\n    i0.ɵɵlistener(\"ngModelChange\", function AgendaComponent_div_31_Template_select_ngModelChange_26_listener($event) {\n      i0.ɵɵrestoreView(_r19);\n      const ctx_r24 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r24.agendamentoForm.servicoIds = $event);\n    });\n    i0.ɵɵtemplate(27, AgendaComponent_div_31_option_27_Template, 3, 6, \"option\", 30);\n    i0.ɵɵpipe(28, \"async\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(29, \"div\", 26)(30, \"label\", 35);\n    i0.ɵɵtext(31, \"Data e Hora:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(32, \"input\", 36);\n    i0.ɵɵlistener(\"ngModelChange\", function AgendaComponent_div_31_Template_input_ngModelChange_32_listener($event) {\n      i0.ɵɵrestoreView(_r19);\n      const ctx_r25 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r25.agendamentoForm.dataHora = $event);\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(33, AgendaComponent_div_31_div_33_Template, 2, 1, \"div\", 37);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(34, \"div\", 38)(35, \"button\", 39);\n    i0.ɵɵlistener(\"click\", function AgendaComponent_div_31_Template_button_click_35_listener() {\n      i0.ɵɵrestoreView(_r19);\n      const ctx_r26 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r26.closeAdminModal());\n    });\n    i0.ɵɵtext(36, \" Cancelar \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(37, \"button\", 40);\n    i0.ɵɵtext(38);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"disabled\", ctx_r6.modalLoading);\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngModel\", ctx_r6.agendamentoForm.clienteId);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(15, 13, ctx_r6.clientes$));\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngModel\", ctx_r6.agendamentoForm.petId)(\"disabled\", ctx_r6.petsDoCliente.length === 0);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r6.petsDoCliente);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r6.agendamentoForm.servicoIds);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(28, 15, ctx_r6.servicos$));\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"ngModel\", ctx_r6.agendamentoForm.dataHora);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r6.modalError);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", ctx_r6.modalLoading);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"disabled\", ctx_r6.modalLoading || !ctx_r6.agendamentoForm.petId || ctx_r6.agendamentoForm.servicoIds.length === 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r6.modalLoading ? \"Salvando...\" : \"Criar Agendamento\", \" \");\n  }\n}\n// === FIM SPRINT 04 ===\n// Cores para os status (Exemplo)\nconst colors = {\n  AGENDADO: {\n    primary: '#007bff',\n    secondary: '#D1E7FD'\n  },\n  CONCLUIDO: {\n    primary: '#198754',\n    secondary: '#D1FAD0'\n  },\n  CANCELADO: {\n    primary: '#6c757d',\n    secondary: '#E2E3E5'\n  }\n};\nexport class AgendaComponent {\n  // === FIM SPRINT 04 ===\n  constructor(agendamentoService) {\n    this.agendamentoService = agendamentoService;\n    // --- Configuração do Calendário ---\n    this.view = CalendarView.Month;\n    this.CalendarView = CalendarView;\n    this.viewDate = new Date();\n    this.locale = 'pt';\n    this.events = [];\n    this.isLoading = true;\n    this.refresh = new Subject();\n    // === INÍCIO SPRINT 04 ===\n    this.errorMessage = null;\n  }\n  ngOnInit() {\n    this.loadAgendamentos();\n  }\n  /**\n   * Carrega os agendamentos do back-end\n   * UC05 - Visão do Administrador (calendário)\n   */\n  loadAgendamentos() {\n    this.isLoading = true;\n    this.errorMessage = null; // Limpa erros anteriores\n    const inicio = startOfWeek(startOfMonth(this.viewDate));\n    const fim = endOfWeek(endOfMonth(this.viewDate));\n    this.agendamentoService.getAgendamentos(inicio.toISOString(), fim.toISOString()).subscribe({\n      next: data => {\n        // Converte a resposta da API para o formato do Calendário\n        this.events = data.map(ag => {\n          // === INÍCIO SPRINT 04 (Adicionar Ações) ===\n          const actions = [];\n          // Só adiciona a ação \"Concluir\" se o status for AGENDADO\n          if (ag.status === 'AGENDADO') {\n            actions.push({\n              label: 'Concluir',\n              cssClass: 'concluir-action',\n              onClick: ({\n                event\n              }) => {\n                this.concluirAgendamento(event); // Chama nosso novo método\n              }\n            });\n          }\n          // === FIM SPRINT 04 ===\n          return {\n            id: ag.id,\n            start: new Date(ag.dataHora),\n            title: `(${ag.status.substring(0, 3)}) ${ag.pet.nome} - ${ag.servicos.map(s => s.nome).join(', ')}`,\n            color: colors[ag.status] || colors.CANCELADO,\n            allDay: false,\n            actions: actions,\n            meta: {\n              agendamento: ag // <-- Guarda o objeto original\n            }\n          };\n        });\n        this.isLoading = false;\n        this.refresh.next();\n      },\n      error: err => {\n        console.error('Erro ao carregar agendamentos', err);\n        this.errorMessage = 'Falha ao carregar agendamentos. Tente novamente.';\n        this.isLoading = false;\n      }\n    });\n  }\n  // === INÍCIO SPRINT 04 (Método para Concluir) ===\n  /**\n   * UC05 - Chamado quando o admin clica na ação \"Concluir\"\n   */\n  concluirAgendamento(event) {\n    const id = event.id;\n    if (!confirm(`Deseja realmente concluir este agendamento?\\n\\n\"${event.title}\"\\n\\nEsta ação dará baixa no estoque.`)) {\n      return;\n    }\n    this.errorMessage = null; // Limpa erros\n    this.agendamentoService.concluirAgendamento(id).subscribe({\n      next: agendamentoAtualizado => {\n        // Sucesso! Atualiza o evento na tela\n        // 1. Atualiza o objeto 'meta' com os dados mais recentes\n        event.meta.agendamento = agendamentoAtualizado;\n        // 2. Atualiza as propriedades visuais do evento\n        event.title = `(CON) ${agendamentoAtualizado.pet.nome} - ${agendamentoAtualizado.servicos.map(s => s.nome).join(', ')}`;\n        event.color = colors.CONCLUIDO;\n        event.actions = []; // Remove a ação \"Concluir\"\n        // 3. Notifica o calendário para redesenhar\n        this.refresh.next();\n      },\n      error: err => {\n        console.error('Erro ao concluir agendamento', err);\n        this.errorMessage = `Erro ao concluir: ${err.error?.message || 'Tente novamente.'}`;\n      }\n    });\n  }\n  // === FIM SPRINT 04 ===\n  /**\n   * Chamado quando o usuário troca de mês ou dia.\n   */\n  onViewDateChange() {\n    this.loadAgendamentos();\n  }\n  /**\n   * Chamado quando o usuário troca a visão (Mês, Semana, Dia).\n   */\n  setView(view) {\n    this.view = view;\n  }\n  static {\n    this.ɵfac = function AgendaComponent_Factory(t) {\n      return new (t || AgendaComponent)(i0.ɵɵdirectiveInject(i1.AgendamentoService));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: AgendaComponent,\n      selectors: [[\"app-agenda\"]],\n      decls: 32,\n      vars: 24,\n      consts: [[1, \"list-container\"], [1, \"page-header\"], [1, \"btn-primary\", \"btn-add\", 3, \"click\"], [1, \"calendar-header\"], [1, \"btn-group\"], [1, \"btn-secondary\", 3, \"click\"], [\"mwlCalendarPreviousView\", \"\", 1, \"btn-secondary\", 3, \"view\", \"viewDate\", \"viewDateChange\"], [\"mwlCalendarToday\", \"\", 1, \"btn-secondary\", 3, \"viewDate\", \"viewDateChange\"], [\"mwlCalendarNextView\", \"\", 1, \"btn-secondary\", 3, \"view\", \"viewDate\", \"viewDateChange\"], [\"class\", \"error-message\", 4, \"ngIf\"], [\"class\", \"loading-indicator\", 4, \"ngIf\"], [1, \"calendar-container\", \"card\", 3, \"ngSwitch\"], [3, \"viewDate\", \"events\", \"refresh\", \"locale\", \"dayClicked\", 4, \"ngSwitchCase\"], [3, \"viewDate\", \"events\", \"refresh\", \"locale\", 4, \"ngSwitchCase\"], [\"class\", \"modal-backdrop\", 3, \"click\", 4, \"ngIf\"], [\"class\", \"modal-content\", 4, \"ngIf\"], [1, \"error-message\"], [1, \"loading-indicator\"], [3, \"viewDate\", \"events\", \"refresh\", \"locale\", \"dayClicked\"], [3, \"viewDate\", \"events\", \"refresh\", \"locale\"], [1, \"modal-backdrop\", 3, \"click\"], [1, \"modal-content\"], [1, \"modal-header\"], [1, \"modal-close\", 3, \"disabled\", \"click\"], [3, \"ngSubmit\"], [1, \"modal-body\"], [1, \"form-group\"], [\"for\", \"cliente\"], [\"id\", \"cliente\", \"name\", \"cliente\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\", \"change\"], [\"value\", \"\", \"disabled\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"for\", \"pet\"], [\"id\", \"pet\", \"name\", \"pet\", \"required\", \"\", 3, \"ngModel\", \"disabled\", \"ngModelChange\"], [\"for\", \"servicos\"], [\"id\", \"servicos\", \"name\", \"servicos\", \"multiple\", \"\", \"required\", \"\", \"size\", \"4\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"dataHora\"], [\"type\", \"datetime-local\", \"id\", \"dataHora\", \"name\", \"dataHora\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [\"class\", \"modal-error-message\", 4, \"ngIf\"], [1, \"modal-footer\"], [\"type\", \"button\", 1, \"btn-secondary\", 3, \"disabled\", \"click\"], [\"type\", \"submit\", 1, \"btn-primary\", 3, \"disabled\"], [3, \"value\"], [1, \"modal-error-message\"]],\n      template: function AgendaComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"header\", 1)(2, \"h1\");\n          i0.ɵɵtext(3, \"Agenda de Agendamentos\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(4, \"button\", 2);\n          i0.ɵɵlistener(\"click\", function AgendaComponent_Template_button_click_4_listener() {\n            return ctx.openAdminModal();\n          });\n          i0.ɵɵtext(5, \" + Novo Agendamento \");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(6, \"div\", 3)(7, \"div\", 4)(8, \"button\", 5);\n          i0.ɵɵlistener(\"click\", function AgendaComponent_Template_button_click_8_listener() {\n            return ctx.setView(ctx.CalendarView.Month);\n          });\n          i0.ɵɵtext(9, \" M\\u00EAs \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(10, \"button\", 5);\n          i0.ɵɵlistener(\"click\", function AgendaComponent_Template_button_click_10_listener() {\n            return ctx.setView(ctx.CalendarView.Week);\n          });\n          i0.ɵɵtext(11, \" Semana \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(12, \"button\", 5);\n          i0.ɵɵlistener(\"click\", function AgendaComponent_Template_button_click_12_listener() {\n            return ctx.setView(ctx.CalendarView.Day);\n          });\n          i0.ɵɵtext(13, \" Dia \");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(14, \"div\", 4)(15, \"button\", 6);\n          i0.ɵɵlistener(\"viewDateChange\", function AgendaComponent_Template_button_viewDateChange_15_listener($event) {\n            return ctx.viewDate = $event;\n          })(\"viewDateChange\", function AgendaComponent_Template_button_viewDateChange_15_listener() {\n            return ctx.onViewDateChange();\n          });\n          i0.ɵɵtext(16, \" Anterior \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(17, \"button\", 7);\n          i0.ɵɵlistener(\"viewDateChange\", function AgendaComponent_Template_button_viewDateChange_17_listener($event) {\n            return ctx.viewDate = $event;\n          })(\"viewDateChange\", function AgendaComponent_Template_button_viewDateChange_17_listener() {\n            return ctx.onViewDateChange();\n          });\n          i0.ɵɵtext(18, \" Hoje \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(19, \"button\", 8);\n          i0.ɵɵlistener(\"viewDateChange\", function AgendaComponent_Template_button_viewDateChange_19_listener($event) {\n            return ctx.viewDate = $event;\n          })(\"viewDateChange\", function AgendaComponent_Template_button_viewDateChange_19_listener() {\n            return ctx.onViewDateChange();\n          });\n          i0.ɵɵtext(20, \" Pr\\u00F3ximo \");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(21, \"h3\");\n          i0.ɵɵtext(22);\n          i0.ɵɵpipe(23, \"calendarDate\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(24, AgendaComponent_div_24_Template, 2, 1, \"div\", 9);\n          i0.ɵɵtemplate(25, AgendaComponent_div_25_Template, 2, 0, \"div\", 10);\n          i0.ɵɵelementStart(26, \"div\", 11);\n          i0.ɵɵtemplate(27, AgendaComponent_mwl_calendar_month_view_27_Template, 1, 4, \"mwl-calendar-month-view\", 12);\n          i0.ɵɵtemplate(28, AgendaComponent_mwl_calendar_week_view_28_Template, 1, 4, \"mwl-calendar-week-view\", 13);\n          i0.ɵɵtemplate(29, AgendaComponent_mwl_calendar_day_view_29_Template, 1, 4, \"mwl-calendar-day-view\", 13);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(30, AgendaComponent_div_30_Template, 1, 0, \"div\", 14);\n          i0.ɵɵtemplate(31, AgendaComponent_div_31_Template, 39, 17, \"div\", 15);\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(8);\n          i0.ɵɵclassProp(\"active\", ctx.view === ctx.CalendarView.Month);\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"active\", ctx.view === ctx.CalendarView.Week);\n          i0.ɵɵadvance(2);\n          i0.ɵɵclassProp(\"active\", ctx.view === ctx.CalendarView.Day);\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"view\", ctx.view)(\"viewDate\", ctx.viewDate);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"viewDate\", ctx.viewDate);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"view\", ctx.view)(\"viewDate\", ctx.viewDate);\n          i0.ɵɵadvance(3);\n          i0.ɵɵtextInterpolate(i0.ɵɵpipeBind3(23, 20, ctx.viewDate, ctx.view + \"ViewTitle\", ctx.locale));\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngIf\", ctx.errorMessage);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.isLoading);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngSwitch\", ctx.view);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngSwitchCase\", ctx.CalendarView.Month);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngSwitchCase\", ctx.CalendarView.Week);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngSwitchCase\", ctx.CalendarView.Day);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.showAdminModal);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.showAdminModal);\n        }\n      },\n      dependencies: [i2.NgForOf, i2.NgIf, i2.NgSwitch, i2.NgSwitchCase, i3.ɵNgNoValidate, i3.NgSelectOption, i3.ɵNgSelectMultipleOption, i3.DefaultValueAccessor, i3.SelectControlValueAccessor, i3.SelectMultipleControlValueAccessor, i3.NgControlStatus, i3.NgControlStatusGroup, i3.RequiredValidator, i3.NgModel, i3.NgForm, i4.ɵCalendarPreviousViewDirective, i4.ɵCalendarNextViewDirective, i4.ɵCalendarTodayDirective, i4.CalendarMonthViewComponent, i4.CalendarWeekViewComponent, i4.CalendarDayViewComponent, i2.AsyncPipe, i2.CurrencyPipe, i4.ɵCalendarDatePipe],\n      styles: [\"\\n\\n\\n.calendar-header[_ngcontent-%COMP%] {\\n  display: flex;\\n  justify-content: space-between;\\n  align-items: center;\\n  margin-bottom: 1.5rem;\\n  padding: 1rem;\\n  background-color: var(--color-white);\\n  border-radius: 8px;\\n  box-shadow: var(--shadow-sm);\\n}\\n\\n.calendar-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%] {\\n  font-size: 1.5rem;\\n  font-weight: 500;\\n  margin: 0;\\n}\\n\\n.btn-group[_ngcontent-%COMP%] {\\n  display: flex;\\n  gap: 0.25rem;\\n}\\n\\n.btn-group[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%] {\\n  background-color: var(--color-light);\\n  color: var(--color-dark);\\n  border: 1px solid var(--color-border);\\n  padding: 8px 12px;\\n}\\n\\n.btn-group[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]:hover {\\n  background-color: #e2e6ea;\\n}\\n\\n.btn-group[_ngcontent-%COMP%]   .btn-secondary.active[_ngcontent-%COMP%] {\\n  background-color: var(--color-primary);\\n  color: var(--color-white);\\n  border-color: var(--color-primary-dark);\\n}\\n\\n.calendar-container.card[_ngcontent-%COMP%] {\\n  background-color: var(--color-white);\\n  border-radius: 8px;\\n  box-shadow: var(--shadow-sm);\\n  padding: 1rem;\\n}\\n\\n\\n\\nmwl-calendar-week-view[_ngcontent-%COMP%], mwl-calendar-day-view[_ngcontent-%COMP%] {\\n  display: block;\\n  height: 600px; \\n\\n}\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n[_nghost-%COMP%]     .concluir-action {\\n  cursor: pointer;\\n  \\n\\n  color: #198754;\\n  font-weight: bold;\\n  margin-left: 8px;\\n  padding: 4px 8px;\\n  border-radius: 4px;\\n  background-color: #d1fad0;\\n  border: 1px solid #198754;\\n  transition: all 0.2s ease-in-out;\\n}\\n\\n[_nghost-%COMP%]     .concluir-action:hover {\\n  background-color: #198754;\\n  color: #fff;\\n}\\n\\n\\n\\n.error-message[_ngcontent-%COMP%] {\\n  \\n\\n  background-color: #f8d7da;\\n  color: #721c24;\\n  border: 1px solid #f5c6cb;\\n  padding: 12px 20px;\\n  border-radius: 8px;\\n  margin: 16px 0;\\n  text-align: center;\\n}\\n\\n\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvZmVhdHVyZXMvYWRtaW4vcGFnZXMvYWdlbmRhL2FnZW5kYS5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLHNEQUFzRDs7QUFFdEQ7RUFDRSxhQUFhO0VBQ2IsOEJBQThCO0VBQzlCLG1CQUFtQjtFQUNuQixxQkFBcUI7RUFDckIsYUFBYTtFQUNiLG9DQUFvQztFQUNwQyxrQkFBa0I7RUFDbEIsNEJBQTRCO0FBQzlCOztBQUVBO0VBQ0UsaUJBQWlCO0VBQ2pCLGdCQUFnQjtFQUNoQixTQUFTO0FBQ1g7O0FBRUE7RUFDRSxhQUFhO0VBQ2IsWUFBWTtBQUNkOztBQUVBO0VBQ0Usb0NBQW9DO0VBQ3BDLHdCQUF3QjtFQUN4QixxQ0FBcUM7RUFDckMsaUJBQWlCO0FBQ25COztBQUVBO0VBQ0UseUJBQXlCO0FBQzNCOztBQUVBO0VBQ0Usc0NBQXNDO0VBQ3RDLHlCQUF5QjtFQUN6Qix1Q0FBdUM7QUFDekM7O0FBRUE7RUFDRSxvQ0FBb0M7RUFDcEMsa0JBQWtCO0VBQ2xCLDRCQUE0QjtFQUM1QixhQUFhO0FBQ2Y7O0FBRUEseUNBQXlDO0FBQ3pDOztFQUVFLGNBQWM7RUFDZCxhQUFhLEVBQUUsd0NBQXdDO0FBQ3pEOztBQUVBLDhDQUE4Qzs7QUFFOUM7Ozs7Q0FJQztBQUNEO0VBQ0UsZUFBZTtFQUNmLHlDQUF5QztFQUN6QyxjQUFjO0VBQ2QsaUJBQWlCO0VBQ2pCLGdCQUFnQjtFQUNoQixnQkFBZ0I7RUFDaEIsa0JBQWtCO0VBQ2xCLHlCQUF5QjtFQUN6Qix5QkFBeUI7RUFDekIsZ0NBQWdDO0FBQ2xDOztBQUVBO0VBQ0UseUJBQXlCO0VBQ3pCLFdBQVc7QUFDYjs7QUFFQSxtQ0FBbUM7QUFDbkM7RUFDRSxrQ0FBa0M7RUFDbEMseUJBQXlCO0VBQ3pCLGNBQWM7RUFDZCx5QkFBeUI7RUFDekIsa0JBQWtCO0VBQ2xCLGtCQUFrQjtFQUNsQixjQUFjO0VBQ2Qsa0JBQWtCO0FBQ3BCO0FBQ0EsMEJBQTBCIiwic291cmNlc0NvbnRlbnQiOlsiLyogKE11aXRvcyBlc3RpbG9zIHPDg8KjbyBoZXJkYWRvcyBkbyBjbGllbnRlLWxpc3QuY3NzKSAqL1xyXG5cclxuLmNhbGVuZGFyLWhlYWRlciB7XHJcbiAgZGlzcGxheTogZmxleDtcclxuICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47XHJcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcclxuICBtYXJnaW4tYm90dG9tOiAxLjVyZW07XHJcbiAgcGFkZGluZzogMXJlbTtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1jb2xvci13aGl0ZSk7XHJcbiAgYm9yZGVyLXJhZGl1czogOHB4O1xyXG4gIGJveC1zaGFkb3c6IHZhcigtLXNoYWRvdy1zbSk7XHJcbn1cclxuXHJcbi5jYWxlbmRhci1oZWFkZXIgaDMge1xyXG4gIGZvbnQtc2l6ZTogMS41cmVtO1xyXG4gIGZvbnQtd2VpZ2h0OiA1MDA7XHJcbiAgbWFyZ2luOiAwO1xyXG59XHJcblxyXG4uYnRuLWdyb3VwIHtcclxuICBkaXNwbGF5OiBmbGV4O1xyXG4gIGdhcDogMC4yNXJlbTtcclxufVxyXG5cclxuLmJ0bi1ncm91cCAuYnRuLXNlY29uZGFyeSB7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tY29sb3ItbGlnaHQpO1xyXG4gIGNvbG9yOiB2YXIoLS1jb2xvci1kYXJrKTtcclxuICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1jb2xvci1ib3JkZXIpO1xyXG4gIHBhZGRpbmc6IDhweCAxMnB4O1xyXG59XHJcblxyXG4uYnRuLWdyb3VwIC5idG4tc2Vjb25kYXJ5OmhvdmVyIHtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjZTJlNmVhO1xyXG59XHJcblxyXG4uYnRuLWdyb3VwIC5idG4tc2Vjb25kYXJ5LmFjdGl2ZSB7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tY29sb3ItcHJpbWFyeSk7XHJcbiAgY29sb3I6IHZhcigtLWNvbG9yLXdoaXRlKTtcclxuICBib3JkZXItY29sb3I6IHZhcigtLWNvbG9yLXByaW1hcnktZGFyayk7XHJcbn1cclxuXHJcbi5jYWxlbmRhci1jb250YWluZXIuY2FyZCB7XHJcbiAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tY29sb3Itd2hpdGUpO1xyXG4gIGJvcmRlci1yYWRpdXM6IDhweDtcclxuICBib3gtc2hhZG93OiB2YXIoLS1zaGFkb3ctc20pO1xyXG4gIHBhZGRpbmc6IDFyZW07XHJcbn1cclxuXHJcbi8qIEZvcsODwqdhIGEgYWx0dXJhIGRhIHZpZXcgZGEgc2VtYW5hL2RpYSAqL1xyXG5td2wtY2FsZW5kYXItd2Vlay12aWV3LFxyXG5td2wtY2FsZW5kYXItZGF5LXZpZXcge1xyXG4gIGRpc3BsYXk6IGJsb2NrO1xyXG4gIGhlaWdodDogNjAwcHg7IC8qIEFsdHVyYSBmaXhhIHBhcmEgbyBzY3JvbGwgZnVuY2lvbmFyICovXHJcbn1cclxuXHJcbi8qID09PSBJTsODwo1DSU8gU1BSSU5UIDA0IChVQzA1IC0gRXN0aWxvcykgPT09ICovXHJcblxyXG4vKlxyXG4gIEVzdGlsbyBwYXJhIGEgYcODwqfDg8KjbyBcIkNvbmNsdWlyXCJcclxuICBVc2Ftb3MgOmhvc3QgOjpuZy1kZWVwIHBhcmEgXCJwZXJmdXJhclwiIGEgZW5jYXBzdWxhw4PCp8ODwqNvXHJcbiAgZGEgYmlibGlvdGVjYSBhbmd1bGFyLWNhbGVuZGFyIGUgZXN0aWxpemFyIG8gYm90w4PCo28uXHJcbiovXHJcbjpob3N0IDo6bmctZGVlcCAuY29uY2x1aXItYWN0aW9uIHtcclxuICBjdXJzb3I6IHBvaW50ZXI7XHJcbiAgLyogQ29yIHZlcmRlIChwYWRyw4PCo28gYm9vdHN0cmFwIHN1Y2Nlc3MpICovXHJcbiAgY29sb3I6ICMxOTg3NTQ7XHJcbiAgZm9udC13ZWlnaHQ6IGJvbGQ7XHJcbiAgbWFyZ2luLWxlZnQ6IDhweDtcclxuICBwYWRkaW5nOiA0cHggOHB4O1xyXG4gIGJvcmRlci1yYWRpdXM6IDRweDtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjZDFmYWQwO1xyXG4gIGJvcmRlcjogMXB4IHNvbGlkICMxOTg3NTQ7XHJcbiAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZS1pbi1vdXQ7XHJcbn1cclxuXHJcbjpob3N0IDo6bmctZGVlcCAuY29uY2x1aXItYWN0aW9uOmhvdmVyIHtcclxuICBiYWNrZ3JvdW5kLWNvbG9yOiAjMTk4NzU0O1xyXG4gIGNvbG9yOiAjZmZmO1xyXG59XHJcblxyXG4vKiBFc3RpbG8gcGFyYSBhIG1lbnNhZ2VtIGRlIGVycm8gKi9cclxuLmVycm9yLW1lc3NhZ2Uge1xyXG4gIC8qIENvcmVzIHBhZHLDg8KjbyBib290c3RyYXAgZGFuZ2VyICovXHJcbiAgYmFja2dyb3VuZC1jb2xvcjogI2Y4ZDdkYTtcclxuICBjb2xvcjogIzcyMWMyNDtcclxuICBib3JkZXI6IDFweCBzb2xpZCAjZjVjNmNiO1xyXG4gIHBhZGRpbmc6IDEycHggMjBweDtcclxuICBib3JkZXItcmFkaXVzOiA4cHg7XHJcbiAgbWFyZ2luOiAxNnB4IDA7XHJcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG59XHJcbi8qID09PSBGSU0gU1BSSU5UIDA0ID09PSAqLyJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n    });\n  }\n}","map":{"version":3,"names":["CalendarView","endOfMonth","startOfMonth","endOfWeek","startOfWeek","Subject","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵadvance","ɵɵtextInterpolate1","ctx_r0","errorMessage","ɵɵlistener","AgendaComponent_mwl_calendar_month_view_27_Template_mwl_calendar_month_view_dayClicked_0_listener","$event","ɵɵrestoreView","_r8","ctx_r7","ɵɵnextContext","setView","Day","ɵɵresetView","viewDate","day","date","ɵɵproperty","ctx_r2","events","refresh","locale","ɵɵelement","ctx_r3","ctx_r4","AgendaComponent_div_30_Template_div_click_0_listener","_r10","ctx_r9","closeAdminModal","cliente_r15","id","nome","pet_r16","servico_r17","ɵɵtextInterpolate2","ɵɵpipeBind2","preco","ctx_r14","modalError","AgendaComponent_div_31_Template_button_click_4_listener","_r19","ctx_r18","AgendaComponent_div_31_Template_form_ngSubmit_6_listener","ctx_r20","onAdminSubmit","AgendaComponent_div_31_Template_select_ngModelChange_11_listener","ctx_r21","agendamentoForm","clienteId","AgendaComponent_div_31_Template_select_change_11_listener","ctx_r22","onClienteChange","ɵɵtemplate","AgendaComponent_div_31_option_14_Template","AgendaComponent_div_31_Template_select_ngModelChange_19_listener","ctx_r23","petId","AgendaComponent_div_31_option_22_Template","AgendaComponent_div_31_Template_select_ngModelChange_26_listener","ctx_r24","servicoIds","AgendaComponent_div_31_option_27_Template","AgendaComponent_div_31_Template_input_ngModelChange_32_listener","ctx_r25","dataHora","AgendaComponent_div_31_div_33_Template","AgendaComponent_div_31_Template_button_click_35_listener","ctx_r26","ctx_r6","modalLoading","ɵɵpipeBind1","clientes$","petsDoCliente","length","servicos$","colors","AGENDADO","primary","secondary","CONCLUIDO","CANCELADO","AgendaComponent","constructor","agendamentoService","view","Month","Date","isLoading","ngOnInit","loadAgendamentos","inicio","fim","getAgendamentos","toISOString","subscribe","next","data","map","ag","actions","status","push","label","cssClass","onClick","event","concluirAgendamento","start","title","substring","pet","servicos","s","join","color","allDay","meta","agendamento","error","err","console","confirm","agendamentoAtualizado","message","onViewDateChange","ɵɵdirectiveInject","i1","AgendamentoService","selectors","decls","vars","consts","template","AgendaComponent_Template","rf","ctx","AgendaComponent_Template_button_click_4_listener","openAdminModal","AgendaComponent_Template_button_click_8_listener","AgendaComponent_Template_button_click_10_listener","Week","AgendaComponent_Template_button_click_12_listener","AgendaComponent_Template_button_viewDateChange_15_listener","AgendaComponent_Template_button_viewDateChange_17_listener","AgendaComponent_Template_button_viewDateChange_19_listener","AgendaComponent_div_24_Template","AgendaComponent_div_25_Template","AgendaComponent_mwl_calendar_month_view_27_Template","AgendaComponent_mwl_calendar_week_view_28_Template","AgendaComponent_mwl_calendar_day_view_29_Template","AgendaComponent_div_30_Template","AgendaComponent_div_31_Template","ɵɵclassProp","ɵɵtextInterpolate","ɵɵpipeBind3","showAdminModal"],"sources":["C:\\TCC\\petflow\\petflow-web\\src\\app\\features\\admin\\pages\\agenda\\agenda.component.ts","C:\\TCC\\petflow\\petflow-web\\src\\app\\features\\admin\\pages\\agenda\\agenda.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { AgendamentoService } from '../../../admin/services/agendamento.service';\r\nimport { AgendamentoResponse } from '../../../admin/models/agendamento.model';\r\n\r\n// Imports do Calendário\r\nimport {\r\nCalendarEvent,\r\nCalendarEventAction, // <-- Importe este\r\nCalendarView\r\n} from 'angular-calendar';\r\nimport {\r\nstartOfDay,\r\nendOfDay,\r\nsubDays,\r\naddDays,\r\nendOfMonth,\r\nisSameDay,\r\nisSameMonth,\r\naddHours,\r\nstartOfMonth,\r\nendOfWeek,\r\nstartOfWeek,\r\n} from 'date-fns';\r\nimport { Subject } from 'rxjs';\r\n// === INÍCIO SPRINT 04 ===\r\n// Import para tratar erros\r\nimport { HttpErrorResponse } from '@angular/common/http';\r\n// === FIM SPRINT 04 ===\r\n\r\n// Cores para os status (Exemplo)\r\nconst colors: any = {\r\nAGENDADO: {\r\nprimary: '#007bff', // Azul\r\nsecondary: '#D1E7FD',\r\n},\r\nCONCLUIDO: {\r\nprimary: '#198754', // Verde\r\nsecondary: '#D1FAD0',\r\n},\r\nCANCELADO: {\r\nprimary: '#6c757d', // Cinza\r\nsecondary: '#E2E3E5',\r\n},\r\n};\r\n\r\n@Component({\r\nselector: 'app-agenda',\r\ntemplateUrl: './agenda.component.html',\r\nstyleUrls: ['./agenda.component.css'] // <-- Mudei para .scss para o estilo da ação\r\n})\r\nexport class AgendaComponent implements OnInit {\r\n\r\n// --- Configuração do Calendário ---\r\nview: CalendarView = CalendarView.Month;\r\nCalendarView = CalendarView;\r\nviewDate: Date = new Date();\r\nlocale: string = 'pt';\r\nevents: CalendarEvent[] = [];\r\nisLoading = true;\r\nrefresh = new Subject<void>();\r\n\r\n// === INÍCIO SPRINT 04 ===\r\nerrorMessage: string | null = null;\r\n// === FIM SPRINT 04 ===\r\n\r\nconstructor(private agendamentoService: AgendamentoService) { }\r\n\r\n  ngOnInit(): void {\r\n    this.loadAgendamentos();\r\n  }\r\n\r\n  /**\r\n   * Carrega os agendamentos do back-end\r\n   * UC05 - Visão do Administrador (calendário)\r\n   */\r\n  loadAgendamentos(): void {\r\n    this.isLoading = true;\r\n    this.errorMessage = null; // Limpa erros anteriores\r\n\r\n    const inicio = startOfWeek(startOfMonth(this.viewDate));\r\n    const fim = endOfWeek(endOfMonth(this.viewDate));\r\n\r\n    this.agendamentoService.getAgendamentos(\r\n      inicio.toISOString(),\r\n      fim.toISOString()\r\n    ).subscribe({\r\n      next: (data) => {\r\n        // Converte a resposta da API para o formato do Calendário\r\n        this.events = data.map((ag: AgendamentoResponse) => {\r\n\r\n          // === INÍCIO SPRINT 04 (Adicionar Ações) ===\r\n          const actions: CalendarEventAction[] = [];\r\n\r\n          // Só adiciona a ação \"Concluir\" se o status for AGENDADO\r\n          if (ag.status === 'AGENDADO') {\r\n            actions.push({\r\n              label: 'Concluir', // Texto da ação\r\n              cssClass: 'concluir-action', // Classe CSS para estilizar\r\n              onClick: ({ event }: { event: CalendarEvent }): void => {\r\n                this.concluirAgendamento(event); // Chama nosso novo método\r\n              },\r\n            });\r\n          }\r\n          // === FIM SPRINT 04 ===\r\n\r\n          return {\r\n            id: ag.id,\r\n            start: new Date(ag.dataHora),\r\n            title: `(${ag.status.substring(0, 3)}) ${ag.pet.nome} - ${ag.servicos.map(s => s.nome).join(', ')}`,\r\n            color: colors[ag.status] || colors.CANCELADO,\r\n            allDay: false,\r\n            actions: actions, // <-- Adiciona as ações ao evento\r\n            meta: {\r\n              agendamento: ag // <-- Guarda o objeto original\r\n            }\r\n          };\r\n        });\r\n        this.isLoading = false;\r\n        this.refresh.next();\r\n      },\r\n      error: (err: HttpErrorResponse) => {\r\n        console.error('Erro ao carregar agendamentos', err);\r\n        this.errorMessage = 'Falha ao carregar agendamentos. Tente novamente.';\r\n        this.isLoading = false;\r\n      }\r\n    });\r\n  }\r\n\r\n  // === INÍCIO SPRINT 04 (Método para Concluir) ===\r\n\r\n  /**\r\n   * UC05 - Chamado quando o admin clica na ação \"Concluir\"\r\n   */\r\n  concluirAgendamento(event: CalendarEvent): void {\r\n    const id = event.id as number;\r\n\r\n    if (!confirm(`Deseja realmente concluir este agendamento?\\n\\n\"${event.title}\"\\n\\nEsta ação dará baixa no estoque.`)) {\r\n      return;\r\n    }\r\n\r\n    this.errorMessage = null; // Limpa erros\r\n\r\n    this.agendamentoService.concluirAgendamento(id).subscribe({\r\n      next: (agendamentoAtualizado) => {\r\n        // Sucesso! Atualiza o evento na tela\r\n\r\n        // 1. Atualiza o objeto 'meta' com os dados mais recentes\r\n        event.meta.agendamento = agendamentoAtualizado;\r\n\r\n        // 2. Atualiza as propriedades visuais do evento\r\n        event.title = `(CON) ${agendamentoAtualizado.pet.nome} - ${agendamentoAtualizado.servicos.map(s => s.nome).join(', ')}`;\r\n        event.color = colors.CONCLUIDO;\r\n        event.actions = []; // Remove a ação \"Concluir\"\r\n\r\n        // 3. Notifica o calendário para redesenhar\r\n        this.refresh.next();\r\n      },\r\n      error: (err: HttpErrorResponse) => {\r\n        console.error('Erro ao concluir agendamento', err);\r\n        this.errorMessage = `Erro ao concluir: ${err.error?.message || 'Tente novamente.'}`;\r\n      }\r\n    });\r\n  }\r\n  // === FIM SPRINT 04 ===\r\n\r\n  /**\r\n   * Chamado quando o usuário troca de mês ou dia.\r\n   */\r\n  onViewDateChange(): void {\r\n    this.loadAgendamentos();\r\n  }\r\n\r\n  /**\r\n   * Chamado quando o usuário troca a visão (Mês, Semana, Dia).\r\n   */\r\n  setView(view: CalendarView): void {\r\n    this.view = view;\r\n  }\r\n}","<div class=\"list-container\">\r\n\r\n    <header class=\"page-header\">\r\n        <h1>Agenda de Agendamentos</h1>\r\n        <button class=\"btn-primary btn-add\" (click)=\"openAdminModal()\">\r\n            + Novo Agendamento\r\n        </button>\r\n    </header>\r\n\r\n    <div class=\"calendar-header\">\r\n        <div class=\"btn-group\">\r\n            <button\r\n                    class=\"btn-secondary\"\r\n                    (click)=\"setView(CalendarView.Month)\"\r\n                    [class.active]=\"view === CalendarView.Month\">\r\n                Mês\r\n            </button>\r\n            <button\r\n                    class=\"btn-secondary\"\r\n                    (click)=\"setView(CalendarView.Week)\"\r\n                    [class.active]=\"view === CalendarView.Week\">\r\n                Semana\r\n            </button>\r\n            <button\r\n                    class=\"btn-secondary\"\r\n                    (click)=\"setView(CalendarView.Day)\"\r\n                    [class.active]=\"view === CalendarView.Day\">\r\n                Dia\r\n            </button>\r\n        </div>\r\n        <div class=\"btn-group\">\r\n            <button\r\n                    class=\"btn-secondary\"\r\n                    mwlCalendarPreviousView\r\n                    [view]=\"view\"\r\n                    [(viewDate)]=\"viewDate\"\r\n                    (viewDateChange)=\"onViewDateChange()\">\r\n                Anterior\r\n            </button>\r\n            <button\r\n                    class=\"btn-secondary\"\r\n                    mwlCalendarToday\r\n                    [(viewDate)]=\"viewDate\"\r\n                    (viewDateChange)=\"onViewDateChange()\">\r\n                Hoje\r\n            </button>\r\n            <button\r\n                    class=\"btn-secondary\"\r\n                    mwlCalendarNextView\r\n                    [view]=\"view\"\r\n                    [(viewDate)]=\"viewDate\"\r\n                    (viewDateChange)=\"onViewDateChange()\">\r\n                Próximo\r\n            </button>\r\n        </div>\r\n        <h3>{{ viewDate | calendarDate:(view + 'ViewTitle'):locale }}</h3>\r\n    </div>\r\n\r\n    <div *ngIf=\"errorMessage\" class=\"error-message\">\r\n        {{ errorMessage }}\r\n    </div>\r\n\r\n    <div *ngIf=\"isLoading\" class=\"loading-indicator\">\r\n        Carregando agendamentos...\r\n    </div>\r\n\r\n    <div [ngSwitch]=\"view\" class=\"calendar-container card\">\r\n        <mwl-calendar-month-view\r\n                *ngSwitchCase=\"CalendarView.Month\"\r\n                [viewDate]=\"viewDate\"\r\n                [events]=\"events\"\r\n                [refresh]=\"refresh\"\r\n                [locale]=\"locale\"\r\n                (dayClicked)=\"setView(CalendarView.Day); viewDate = $event.day.date\">\r\n        </mwl-calendar-month-view>\r\n\r\n        <mwl-calendar-week-view\r\n                *ngSwitchCase=\"CalendarView.Week\"\r\n                [viewDate]=\"viewDate\"\r\n                [events]=\"events\"\r\n                [refresh]=\"refresh\"\r\n                [locale]=\"locale\">\r\n        </mwl-calendar-week-view>\r\n\r\n        <mwl-calendar-day-view\r\n                *ngSwitchCase=\"CalendarView.Day\"\r\n                [viewDate]=\"viewDate\"\r\n                [events]=\"events\"\r\n                [refresh]=\"refresh\"\r\n                [locale]=\"locale\">\r\n        </mwl-calendar-day-view>\r\n    </div>\r\n</div>\r\n\r\n\r\n<div *ngIf=\"showAdminModal\" class=\"modal-backdrop\" (click)=\"closeAdminModal()\"></div>\r\n\r\n<div *ngIf=\"showAdminModal\" class=\"modal-content\">\r\n\r\n    <div class=\"modal-header\">\r\n        <h2>Novo Agendamento (Admin)</h2>\r\n        <button class=\"modal-close\" (click)=\"closeAdminModal()\" [disabled]=\"modalLoading\">&times;</button>\r\n    </div>\r\n\r\n    <form (ngSubmit)=\"onAdminSubmit()\">\r\n        <div class=\"modal-body\">\r\n\r\n            <div class=\"form-group\">\r\n                <label for=\"cliente\">Cliente:</label>\r\n                <select id=\"cliente\" [(ngModel)]=\"agendamentoForm.clienteId\" name=\"cliente\"\r\n                        (change)=\"onClienteChange($event)\" required>\r\n                    <option value=\"\" disabled>Selecione um cliente...</option>\r\n                    <option *ngFor=\"let cliente of (clientes$ | async)\" [value]=\"cliente.id\">\r\n                        {{ cliente.nome }}\r\n                    </option>\r\n                </select>\r\n            </div>\r\n\r\n            <div class=\"form-group\">\r\n                <label for=\"pet\">Pet:</label>\r\n                <select id=\"pet\" [(ngModel)]=\"agendamentoForm.petId\" name=\"pet\"\r\n                        [disabled]=\"petsDoCliente.length === 0\" required>\r\n                    <option value=\"\" disabled>Selecione um pet...</option>\r\n                    <option *ngFor=\"let pet of petsDoCliente\" [value]=\"pet.id\">\r\n                        {{ pet.nome }}\r\n                    </option>\r\n                </select>\r\n            </div>\r\n\r\n            <div class=\"form-group\">\r\n                <label for=\"servicos\">Serviços:</label>\r\n                <select id=\"servicos\" [(ngModel)]=\"agendamentoForm.servicoIds\" name=\"servicos\"\r\n                        multiple required size=\"4\">\r\n                    <option *ngFor=\"let servico of (servicos$ | async)\" [value]=\"servico.id\">\r\n                        {{ servico.nome }} ({{ servico.preco | currency:'BRL' }})\r\n                    </option>\r\n                </select>\r\n            </div>\r\n\r\n            <div class=\"form-group\">\r\n                <label for=\"dataHora\">Data e Hora:</label>\r\n                <input type=\"datetime-local\" id=\"dataHora\" [(ngModel)]=\"agendamentoForm.dataHora\"\r\n                       name=\"dataHora\" required />\r\n            </div>\r\n\r\n            <div *ngIf=\"modalError\" class=\"modal-error-message\">\r\n                {{ modalError }}\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"modal-footer\">\r\n            <button type=\"button\" class=\"btn-secondary\" (click)=\"closeAdminModal()\" [disabled]=\"modalLoading\">\r\n                Cancelar\r\n            </button>\r\n            <button type=\"submit\" class=\"btn-primary\" [disabled]=\"modalLoading || !agendamentoForm.petId || agendamentoForm.servicoIds.length === 0\">\r\n                {{ modalLoading ? 'Salvando...' : 'Criar Agendamento' }}\r\n            </button>\r\n        </div>\r\n    </form>\r\n</div>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}